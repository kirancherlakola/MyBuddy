{% extends "base.html" %}
{% block title %}{% if note %}Edit Note{% else %}New Note{% endif %} â€” MyBuddy{% endblock %}
{% block content %}
<h2>{% if note %}Edit Note{% else %}New Note{% endif %}</h2>

<details open class="ocr-upload">
    <summary>ðŸ“· Upload image for text extraction</summary>
    <form hx-post="/notes/ocr-image" hx-encoding="multipart/form-data" hx-target="#ocr-result" hx-indicator="#ocr-spinner">
        <label for="file">Select an image (JPEG, PNG, GIF, or WebP, max 5 MB)</label>
        <input type="file" id="file" name="file" accept="image/jpeg,image/png,image/gif,image/webp" required>
        <button type="submit">Extract Text</button>
        <span id="ocr-spinner" class="htmx-indicator" aria-busy="true">Extracting text...</span>
    </form>
    <div id="ocr-result"></div>
</details>

<form method="post" action="{% if note %}/notes/{{ note.id }}/update{% else %}/notes{% endif %}">
    <label for="title">Title</label>
    <input type="text" id="title" name="title" value="{{ note.title if note else '' }}" required placeholder="Meeting with Sarah about project">

    <label for="content">Content</label>
    <textarea id="content" name="content" rows="10" placeholder="Write your notes here...">{{ note.content if note else '' }}</textarea>

    <div class="actions-bar">
        <a href="{% if note %}/notes/{{ note.id }}{% else %}/notes{% endif %}">Cancel</a>
        <button type="submit">{% if note %}Update{% else %}Create{% endif %} Note</button>
    </div>
</form>
{% endblock %}
